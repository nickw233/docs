import{d as pe,u as _e,b as h,aC as v,H as fe,m as l,o as d,c as b,j as t,w as n,k as a,h as C,a2 as P,N as ge,q as c,t as I,dh as L,O as Ce,B as w,dL as ve,F as $,n as D,C as T,a9 as be,aI as we,R as ye,aa as N,a as ke}from"./index-3cca530d.js";import{F as z}from"./fileTypeEnum-21359a08.js";import{u as Ee,E as u}from"./chartEditStore-eacdd3b3.js";/* empty css                                                                      */import{l as V}from"./index-6270b1c7.js";import{i as A}from"./icon-8135a16a.js";import{S as Se}from"./StylesSetting-18211869.js";import{b as he}from"./project.api-cdb3f370.js";import"./plugin-ede68460.js";import"./SettingItem-281a83da.js";import"./SettingItemBox-54f3c96d.js";import"./CollapseItem.vue_vue_type_script_setup_true_lang-47c71c0e.js";import"./logo-9c330988.js";const Ie=""+new URL("../png/noImage.png",import.meta.url).href,Le={class:"go-canvas-setting"},Te={class:"upload-box"},ze=["src"],Re={class:"upload-img"},xe={class:"picker-height"},Oe=pe({__name:"index",setup(Fe){const{ColorPaletteIcon:R}=A.ionicons5,{ScaleIcon:B,FitToScreenIcon:G,FitToHeightIcon:H,FitToWidthIcon:M}=A.carbon,r=Ee(),Y=_e(),s=r.getEditCanvasConfig,x=r.getEditCanvas,y=h(),k=h(!1),E=h(0),K=V(()=>N(()=>import("./index-05b69f8c.js"),["./index-05b69f8c.js","./index-3cca530d.js","../css/index-fa45cf35.css","./chartEditStore-eacdd3b3.js","./plugin-ede68460.js","./icon-8135a16a.js","./index-6270b1c7.js","../css/index-86a264d4.css","../css/index-726745ff.css"],import.meta.url)),X=V(()=>N(()=>import("./index-83621d7f.js"),["./index-83621d7f.js","./index-3cca530d.js","../css/index-fa45cf35.css","./useVCharts.hook-51dd6e3b.js","./vchart-3818fc35.js","./chartEditStore-eacdd3b3.js","./plugin-ede68460.js","./icon-8135a16a.js","../css/index-458b0c38.css"],import.meta.url)),j=[{label:"应用颜色",value:0},{label:"应用背景",value:1}],q=[{key:"ChartTheme",title:"默认主题",icon:R,render:K},{key:"VChartTheme",title:"VChart主题",icon:R,render:X}],W=[{key:v.FIT,title:"自适应",icon:B,desc:"自适应比例展示，页面会有留白"},{key:v.SCROLL_Y,title:"Y轴滚动",icon:M,desc:"X轴铺满，Y轴自适应滚动"},{key:v.SCROLL_X,title:"X轴滚动",icon:H,desc:"Y轴铺满，X轴自适应滚动"},{key:v.FULL,title:"铺满",icon:G,desc:"强行拉伸画面，填充所有视图"}];fe(()=>s.selectColor,i=>{E.value=i?0:1},{immediate:!0});const O=i=>i>50,F=()=>{r.computedScale()},J=async({file:i})=>{y.value=[];const e=i.file.type;return i.file.size>1024*1024*L?(window.$message.warning(`图片超出 ${L}M 限制，请重新上传！`),!1):e!==z.PNG&&e!==z.JPEG&&e!==z.GIF?(window.$message.warning("文件格式不符合，请重新上传！"),!1):!0},Q=i=>{s.selectColor=i==0},Z=()=>{r.setEditCanvasConfig(u.BACKGROUND_IMAGE,void 0),r.setEditCanvasConfig(u.SELECT_COLOR,!0)},ee=()=>{k.value=!0,setTimeout(()=>{k.value=!1})},te=()=>{r.setEditCanvasConfig(u.BACKGROUND,void 0),s.backgroundImage&&r.setEditCanvasConfig(u.SELECT_COLOR,!1),ee()},ne=i=>{const{file:e}=i;be(async()=>{if(e.file){const _=new File([e.file],`${we()}_index_background.png`,{type:e.file.type});let f=new FormData;f.append("object",_),window.$message.warn("该上传接口与项目预览图为同一个，请自行在后端新增一个上传背景图接口");const m=await he(f);if(m&&m.code===ye.SUCCESS){m.data.fileurl?r.setEditCanvasConfig(u.BACKGROUND_IMAGE,`${m.data.fileurl}?time=${new Date().getTime()}`):r.setEditCanvasConfig(u.BACKGROUND_IMAGE,`${Y.getFetchInfo.OSSUrl||""}${m.data.fileName}?time=${new Date().getTime()}`),r.setEditCanvasConfig(u.SELECT_COLOR,!1);return}window.$message.error("添加图片失败，请稍后重试！")}else window.$message.error("添加图片失败，请稍后重试！")})},oe=i=>{r.setEditCanvasConfig(u.PREVIEW_SCALE_TYPE,i)};return(i,e)=>{const _=l("n-input-number"),f=l("n-form-item"),m=l("n-form"),g=l("n-text"),ae=l("n-upload-dragger"),se=l("n-upload"),le=l("n-color-picker"),p=l("n-space"),ie=l("n-select"),S=l("n-button"),U=l("n-icon"),re=l("n-tooltip"),de=l("n-button-group"),ce=l("n-divider"),ue=l("n-tab-pane"),me=l("n-tabs");return d(),b("div",Le,[t(m,{inline:"","label-width":45,size:"small","label-placement":"left"},{default:n(()=>[t(f,{label:"宽度"},{default:n(()=>[t(_,{size:"small",value:a(s).width,"onUpdate:value":[e[0]||(e[0]=o=>a(s).width=o),F],disabled:a(x).lockScale,validator:O},null,8,["value","disabled"])]),_:1}),t(f,{label:"高度"},{default:n(()=>[t(_,{size:"small",value:a(s).height,"onUpdate:value":[e[1]||(e[1]=o=>a(s).height=o),F],disabled:a(x).lockScale,validator:O},null,8,["value","disabled"])]),_:1})]),_:1}),C("div",Te,[t(se,{"file-list":y.value,"onUpdate:fileList":e[2]||(e[2]=o=>y.value=o),"show-file-list":!1,customRequest:ne,onBeforeUpload:J},{default:n(()=>[t(ae,null,{default:n(()=>[a(s).backgroundImage?(d(),b("img",{key:0,class:"upload-show",src:a(s).backgroundImage,alt:"背景"},null,8,ze)):P("",!0),ge(C("div",Re,[e[5]||(e[5]=C("img",{src:Ie},null,-1)),t(g,{class:"upload-desc",depth:"3"},{default:n(()=>[c(" 背景图需小于 "+I(a(L))+"M ，格式为 png/jpg/gif 的文件 ",1)]),_:1})],512),[[Ce,!a(s).backgroundImage]])]),_:1})]),_:1},8,["file-list"])]),t(p,{vertical:"",size:12},{default:n(()=>[t(p,null,{default:n(()=>[t(g,null,{default:n(()=>e[6]||(e[6]=[c("背景颜色")])),_:1}),C("div",xe,[k.value?P("",!0):(d(),w(le,{key:0,size:"small",style:{width:"250px"},value:a(s).background,"onUpdate:value":e[3]||(e[3]=o=>a(s).background=o),showPreview:!0,swatches:a(ve)},null,8,["value","swatches"]))])]),_:1}),t(p,null,{default:n(()=>[t(g,null,{default:n(()=>e[7]||(e[7]=[c("应用类型")])),_:1}),t(ie,{size:"small",style:{width:"250px"},value:E.value,"onUpdate:value":[e[4]||(e[4]=o=>E.value=o),Q],disabled:!a(s).backgroundImage,options:j},null,8,["value","disabled"])]),_:1}),t(p,null,{default:n(()=>[t(g,null,{default:n(()=>e[8]||(e[8]=[c("背景控制")])),_:1}),t(S,{class:"clear-btn",size:"small",disabled:!a(s).backgroundImage,onClick:Z},{default:n(()=>e[9]||(e[9]=[c(" 清除背景 ")])),_:1},8,["disabled"]),t(S,{class:"clear-btn",size:"small",disabled:!a(s).background,onClick:te},{default:n(()=>e[10]||(e[10]=[c(" 清除颜色 ")])),_:1},8,["disabled"])]),_:1}),t(p,null,{default:n(()=>[t(g,null,{default:n(()=>e[11]||(e[11]=[c("适配方式")])),_:1}),t(de,null,{default:n(()=>[(d(),b($,null,D(W,o=>t(S,{key:o.key,type:a(s).previewScaleType===o.key?"primary":"tertiary",ghost:"",size:"small",onClick:Ue=>oe(o.key)},{default:n(()=>[t(re,{"show-arrow":!1,trigger:"hover"},{trigger:n(()=>[t(U,{class:"select-preview-icon",size:"18"},{default:n(()=>[(d(),w(T(o.icon)))]),_:2},1024)]),default:n(()=>[c(" "+I(o.desc),1)]),_:2},1024)]),_:2},1032,["type","onClick"])),64))]),_:1})]),_:1})]),_:1}),t(a(Se),{isCanvas:!0,chartStyles:a(s)},null,8,["chartStyles"]),t(ce,{style:{margin:"10px 0"}}),t(me,{class:"tabs-box",size:"small",type:"segment"},{default:n(()=>[(d(),b($,null,D(q,o=>t(ue,{key:o.key,name:o.key,size:"small","display-directive":"show:lazy"},{tab:n(()=>[t(p,null,{default:n(()=>[C("span",null,I(o.title),1),t(U,{size:"16",class:"icon-position"},{default:n(()=>[(d(),w(T(o.icon)))]),_:2},1024)]),_:2},1024)]),default:n(()=>[(d(),w(T(o.render)))]),_:2},1032,["name"])),64))]),_:1})])}}});const je=ke(Oe,[["__scopeId","data-v-fd359552"]]);export{je as default};
