import{d as U,b as g,a4 as P,z as J,b3 as q,Y as M,b4 as W,m as c,o as m,c as T,j as o,w as e,F as k,n as Y,B as A,C as K,h as Q,t as w,q as u,k as x,aI as X,R as Z,a5 as ee,U as S,J as te,b5 as oe,aJ as se,ag as f,aF as C,L as ne,a as ae}from"./index-3cca530d.js";import{u as re}from"./index-6270b1c7.js";import{u as ie,P as le}from"./chartEditStore-eacdd3b3.js";import{s as ce}from"./useSyncUpdate.hook-a702f6d2.js";import{a as pe}from"./project.api-cdb3f370.js";import{i as ue}from"./icon-8135a16a.js";import"./plugin-ede68460.js";import"./useSync.hook-0f97b777.js";import"./chartLayoutStore-42609aea.js";import"./index-e27881ef.js";import"./SettingItem-281a83da.js";/* empty css                                                                      */import"./SettingItemBox-54f3c96d.js";import"./CollapseItem.vue_vue_type_script_setup_true_lang-47c71c0e.js";import"./index.esm.min-1d723dc8.js";import"./vchart-3818fc35.js";import"./fileTypeEnum-21359a08.js";const de=U({__name:"index",setup(_e){const{BrowsersOutlineIcon:L,SendIcon:b,AnalyticsIcon:H,CloseIcon:B}=ue.ionicons5,d=ie(),O=g(P()),{copy:G,isSupported:j}=re({source:O}),N=J(),p=g(!1),r=g(!1);q(()=>{r.value=d.getProjectInfo.release||!1});const E=()=>{p.value=!1},z=()=>{const s=te(oe.CHART_PREVIEW_NAME,"href");if(!s)return;const{id:t}=N.params,n=typeof t=="string"?t:t[0],a=d.getStorageInfo(),i=se(f.GO_CHART_STORAGE_LIST)||[];if(i?.length){const _=i.findIndex(y=>y.id===n);_!==-1?(i.splice(_,1,{id:n,...a}),C(f.GO_CHART_STORAGE_LIST,i)):(i.push({id:n,...a}),C(f.GO_CHART_STORAGE_LIST,i))}else C(f.GO_CHART_STORAGE_LIST,[{id:n,...a}]);ne(s,[n],void 0,!0)},v=()=>{p.value=!p.value},I=(s,t)=>{j?(G(),window.$message.success(s||"复制成功！")):window.$message.error(t||"复制失败！")},D=async()=>{const s=await pe({id:X(),state:r.value?-1:1});s&&s.code===Z.SUCCESS?(v(),r.value?window.$message.success("已取消发布"):I("发布成功！已复制地址到剪贴板~","发布成功！"),d.setProjectInfo(le.RELEASE,!r.value)):ee()},h=[{select:!0,title:()=>"同步内容",type:()=>"primary",icon:S(H),event:ce},{key:"preview",title:()=>"预览",type:()=>"default",icon:S(L),event:z},{key:"release",title:()=>r.value?"已发布":"发布",icon:S(b),type:()=>r.value?"primary":"default",event:v}],V=M(()=>{if(d.getEditCanvas.isCodeEdit)return h;const s=W.cloneDeep(h);return s.shift(),s});return(s,t)=>{const n=c("n-button"),a=c("n-space"),i=c("n-h3"),_=c("n-icon"),y=c("n-alert"),R=c("n-list-item"),$=c("n-list"),F=c("n-modal");return m(),T(k,null,[o(a,{class:"go-mt-0",wrap:!1},{default:e(()=>[(m(!0),T(k,null,Y(V.value,l=>(m(),A(n,{key:l.key,type:l.type(),ghost:"",onClick:l.event},{icon:e(()=>[(m(),A(K(l.icon)))]),default:e(()=>[Q("span",null,w(l.title()),1)]),_:2},1032,["type","onClick"]))),128))]),_:1}),o(F,{show:p.value,"onUpdate:show":t[1]||(t[1]=l=>p.value=l),onAfterLeave:E},{default:e(()=>[o($,{bordered:"",class:"go-system-setting"},{header:e(()=>[o(a,{justify:"space-between"},{default:e(()=>[o(i,{class:"go-mb-0"},{default:e(()=>t[2]||(t[2]=[u("发布管理")])),_:1}),o(_,{size:"20",class:"go-cursor-pointer",onClick:E},{default:e(()=>[o(x(B))]),_:1})]),_:1})]),default:e(()=>[o(R,null,{default:e(()=>[o(a,{size:10},{default:e(()=>[o(y,{"show-icon":!1,title:"预览地址：",type:"success"},{default:e(()=>[u(w(x(P)()),1)]),_:1}),o(a,{vertical:""},{default:e(()=>[o(n,{tertiary:"",type:"primary",onClick:t[0]||(t[0]=l=>I())},{default:e(()=>t[3]||(t[3]=[u(" 复制地址 ")])),_:1}),o(n,{type:r.value?"warning":"primary",onClick:D},{default:e(()=>[u(w(r.value?"取消发布":"发布大屏"),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1}),o(R,null,{default:e(()=>[o(a,{size:10},{default:e(()=>[o(n,{onClick:v},{default:e(()=>t[4]||(t[4]=[u("关闭弹窗")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])],64)}}});const Le=ae(de,[["__scopeId","data-v-57a67993"]]);export{Le as default};
