import{d as M,e as A,E as x,U as I,b as S,m as s,o as i,c as C,j as e,w as a,h as g,q as P,t as B,F as L,n as q,B as f,C as R,k as n,a1 as ne,a2 as K,a as N,H as oe,J as se,G as ce,L as le,a3 as ie,a4 as re,a5 as O,R as G,N as J,O as W}from"./index-3cca530d.js";import{i as Q}from"./icon-8135a16a.js";import{M as X}from"./index-4c3bf959.js";import{p as de,d as _e,a as ue}from"./project.api-cdb3f370.js";import{g as me,D as pe}from"./plugin-ede68460.js";const ge={key:0,class:"go-items-list-card"},ve={class:"list-content"},he={class:"list-content-top"},fe={class:"go-flex-items-center list-footer",justify:"space-between"},we={class:"go-flex-items-center list-footer-ri"},be=M({__name:"index",props:{cardData:Object},emits:["preview","delete","resize","edit","release"],setup(t,{emit:l}){const{EllipsisHorizontalCircleSharpIcon:v,CopyIcon:u,TrashIcon:b,PencilIcon:y,DownloadIcon:_,BrowsersOutlineIcon:w,HammerIcon:o,SendIcon:m}=Q.ionicons5,c=l,r=t,p=A([{label:x("global.r_edit"),key:"edit",icon:I(o)},{lable:x("global.r_more"),key:"select",icon:I(v)}]),h=S([{label:x("global.r_preview"),key:"preview",icon:I(w)},{label:r.cardData?.release?x("global.r_unpublish"):x("global.r_publish"),key:"release",icon:I(m)},{label:x("global.r_delete"),key:"delete",icon:I(b)}]),D=d=>{switch(d){case"preview":H();break;case"delete":k();break;case"release":E();break;case"edit":j();break}},H=()=>{c("preview",r.cardData)},k=()=>{c("delete",r.cardData)},j=()=>{c("edit",r.cardData)},E=()=>{c("release",r.cardData)},$=()=>{c("resize",r.cardData)};return(d,U)=>{const T=s("n-image"),V=s("n-text"),Y=s("n-badge"),F=s("n-button"),Z=s("n-dropdown"),ee=s("n-tooltip"),te=s("n-space"),ae=s("n-card");return t.cardData?(i(),C("div",ge,[e(ae,{hoverable:"",size:"small"},{action:a(()=>[g("div",fe,[e(V,{class:"go-ellipsis-1"},{default:a(()=>[P(B(t.cardData.title||t.cardData.id||"未命名"),1)]),_:1}),g("div",we,[e(te,null,{default:a(()=>[e(V,null,{default:a(()=>[e(Y,{class:"go-animation-twinkle",dot:"",color:t.cardData.release?"#34c749":"#fcbc40"},null,8,["color"]),P(" "+B(t.cardData.release?d.$t("project.release"):d.$t("project.unreleased")),1)]),_:1}),(i(!0),C(L,null,q(p,z=>(i(),C(L,{key:z.key},[z.key==="select"?(i(),f(Z,{key:0,trigger:"hover",placement:"bottom",options:h.value,"show-arrow":!0,onSelect:D},{default:a(()=>[e(F,{size:"small"},{icon:a(()=>[(i(),f(R(z.icon)))]),_:2},1024)]),_:2},1032,["options"])):(i(),f(ee,{key:1,placement:"bottom",trigger:"hover"},{trigger:a(()=>[e(F,{size:"small",onClick:Re=>D(z.key)},{icon:a(()=>[(i(),f(R(z.icon)))]),_:2},1032,["onClick"])]),default:a(()=>[(i(),f(R(z.label)))]),_:2},1024))],64))),128))]),_:1})])])]),default:a(()=>[g("div",ve,[g("div",he,[e(n(X),{class:"top-btn",hidden:["remove"],onClose:k,onResize:$})]),g("div",{class:"list-content-img",onClick:$},[e(T,{"object-fit":"contain",height:"180","preview-disabled":"",src:`${t.cardData.image}?time=${new Date().getTime()}`,alt:t.cardData.title,"fallback-src":n(ne)()},null,8,["src","alt","fallback-src"])])])]),_:1})])):K("",!0)}}});const ye=N(be,[["__scopeId","data-v-0814e2b8"]]),ke={class:"list-content"},De={class:"list-content-img"},xe=["src","alt"],Ce=M({__name:"index",props:{modalShow:{required:!0,type:Boolean},cardData:{required:!0,type:Object}},emits:["close","edit"],setup(t,{emit:l}){const{HammerIcon:v}=Q.ionicons5,u=S(!1),b=l,y=t;oe(()=>y.modalShow,c=>{u.value=c},{immediate:!0});const _=A([{label:x("global.r_edit"),key:"edit",icon:I(v)}]),w=c=>{switch(c){case"edit":o();break}},o=()=>{b("edit",y.cardData)},m=()=>{b("close")};return(c,r)=>{const p=s("n-text"),h=s("n-space"),D=s("n-time"),H=s("n-badge"),k=s("n-button"),j=s("n-tooltip"),E=s("n-card"),$=s("n-modal");return i(),f($,{class:"go-modal-box",show:u.value,"onUpdate:show":r[0]||(r[0]=d=>u.value=d),"mask-closable":!0,onAfterLeave:m},{default:a(()=>[e(E,{hoverable:"",size:"small"},{action:a(()=>[e(h,{class:"list-footer",justify:"space-between"},{default:a(()=>[e(p,{depth:"3"},{default:a(()=>[P(B(c.$t("project.last_edit"))+": ",1),e(D,{time:new Date,format:"yyyy-MM-dd hh:mm"},null,8,["time"])]),_:1}),e(h,null,{default:a(()=>[e(p,null,{default:a(()=>[e(H,{class:"go-animation-twinkle",dot:"",color:t.cardData?.release?"#34c749":"#fcbc40"},null,8,["color"]),P(" "+B(t.cardData?.release?c.$t("project.release"):c.$t("project.unreleased")),1)]),_:1}),(i(!0),C(L,null,q(_,d=>(i(),f(j,{key:d.key,placement:"bottom",trigger:"hover"},{trigger:a(()=>[e(k,{size:"small",onClick:U=>w(d.key)},{icon:a(()=>[(i(),f(R(d.icon)))]),_:2},1032,["onClick"])]),default:a(()=>[(i(),f(R(d.label)))]),_:2},1024))),128))]),_:1})]),_:1})]),default:a(()=>[g("div",ke,[e(h,{class:"list-content-top go-px-0",justify:"center"},{default:a(()=>[e(h,null,{default:a(()=>[e(p,null,{default:a(()=>[P(B(t.cardData?.title||t.cardData?.id||"未命名"),1)]),_:1})]),_:1})]),_:1}),e(h,{class:"list-content-top"},{default:a(()=>[e(n(X),{narrow:!0,hidden:["close"],onRemove:m})]),_:1}),g("div",De,[g("img",{src:t.cardData?.image,alt:t.cardData?.title},null,8,xe)])])]),_:1})]),_:1},8,["show"])}}});const He=N(Ce,[["__scopeId","data-v-c853dce2"]]),$e=()=>{const t=S(!1),l=S(null);return{modalData:l,modalShow:t,closeModal:()=>{t.value=!1,l.value=null},resizeHandle:_=>{_&&(t.value=!0,l.value=_)},editHandle:_=>{if(!_)return;const w=se(ce.CHART_HOME_NAME,"href");le(w,[_.id],void 0,!0)},previewHandle:_=>{ie(re(_.id))}}},ze=()=>{const t=S(!0),l=A({page:1,limit:12,count:10}),v=S([]),u=async()=>{t.value=!0;const o=await de({page:l.page,limit:l.limit});if(o&&o.data){const{count:m}=o;l.count=m,v.value=o.data.map(c=>{const{id:r,projectName:p,state:h,createTime:D,indexImage:H,createUserId:k}=c;return{id:r,title:p,createId:k,time:D,image:H,release:h!==-1}}),setTimeout(()=>{t.value=!1},500);return}O()},b=o=>{l.page=o,u()},y=o=>{l.limit=o,u()},_=o=>{me({type:pe.DELETE,promise:!0,onPositiveCallback:()=>new Promise(m=>{m(_e({ids:o.id}))}),promiseResCallback:m=>{if(m.code===G.SUCCESS){window.$message.success(window.$t("global.r_delete_success")),u();return}O()}})},w=async(o,m)=>{const{id:c,release:r}=o,p=await ue({id:c,state:r?-1:1});if(p&&p.code===G.SUCCESS){if(v.value=[],u(),r){window.$message.success(window.$t("global.r_unpublish_success"));return}window.$message.success(window.$t("global.r_publish_success"));return}O()};return u(),{loading:t,paginat:l,list:v,fetchList:u,releaseHandle:w,changeSize:y,changePage:b,deleteHandle:_}},Ie={class:"go-items-list"},Se={class:"list-pagination"},je=M({__name:"index",setup(t){const{modalData:l,modalShow:v,closeModal:u,previewHandle:b,resizeHandle:y,editHandle:_}=$e(),{loading:w,paginat:o,list:m,changeSize:c,changePage:r,releaseHandle:p,deleteHandle:h}=ze();return(D,H)=>{const k=s("go-loading"),j=s("n-grid-item"),E=s("n-grid"),$=s("n-pagination");return i(),C(L,null,[g("div",Ie,[J(g("div",null,[e(k)],512),[[W,n(w)]]),J(g("div",null,[e(E,{"x-gap":20,"y-gap":20,cols:"2 s:2 m:3 l:4 xl:4 xxl:4",responsive:"screen"},{default:a(()=>[(i(!0),C(L,null,q(n(m),(d,U)=>(i(),f(j,{key:d.id},{default:a(()=>[e(n(ye),{cardData:d,onPreview:n(b),onResize:n(y),onDelete:T=>n(h)(d),onRelease:T=>n(p)(d,U),onEdit:n(_)},null,8,["cardData","onPreview","onResize","onDelete","onRelease","onEdit"])]),_:2},1024))),128))]),_:1})],512),[[W,!n(w)]]),g("div",Se,[e($,{page:n(o).page,"page-size":n(o).limit,"item-count":n(o).count,"page-sizes":[12,24,36,48],"onUpdate:page":n(r),"onUpdate:pageSize":n(c),"show-size-picker":""},null,8,["page","page-size","item-count","onUpdate:page","onUpdate:pageSize"])])]),n(l)?(i(),f(n(He),{key:0,modalShow:n(v),cardData:n(l),onClose:n(u),onEdit:n(_)},null,8,["modalShow","cardData","onClose","onEdit"])):K("",!0)],64)}}});const Ee=N(je,[["__scopeId","data-v-c7933e27"]]),Pe={class:"go-project-items"},Be=M({__name:"index",setup(t){return(l,v)=>(i(),C("div",Pe,[e(n(Ee))]))}});const Oe=N(Be,[["__scopeId","data-v-ba0e1d55"]]);export{Oe as default};
